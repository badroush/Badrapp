{% extends 'base.html.twig' %}

<<<<<<< HEAD
{% block title %}Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©{% endblock %}
{% block stylesheets %}
	<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
rel="stylesheet" />
{% endblock %}
{% block body %}
	<div class="container mt-4">
		<div class="card shadow-sm">
			<div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
				<h2 class="mb-0">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
=======
{% block title %}Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©
{% endblock %}

{% block body %}
	{% include "layout/header.html.twig" %}
	<div class="container mt-4">
		<div class="card">
			<div class="card-header">
				<h2>â• Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
>>>>>>> d6476d60ab6c137fd57e0e94d3b5e16948081daa
			</div>
			<div class="card-body">
				{{ form_start(form) }}
				<div class="row">
					<div class="col-md-6">
<<<<<<< HEAD
						{# {{ form_row(form.reference, {'label': 'Ø§Ù„Ù…Ø±Ø¬Ø¹'}) }}
						<br> #}
						{{ form_row(form.libelleMateriel, {'label': 'Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©'}) }}
						<label id="libelleMateriel-selection-label" class="form-label mt-2 text-muted"> Ù„Ù… ØªØ­Ø¯Ø¯ Ù…Ø§Ø¯Ø© </label>
						{{ form_row(form.serie, {'label': 'Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ'}) }}
						{{ form_row(form.emplacement, {'label': 'Ø§Ù„Ù…ÙˆÙ‚Ø¹'}) }}
                        <label id="emplacement-selection-label" class="form-label mt-2 text-muted">Ù„Ù… ØªØ­Ø¯Ø¯ Ù…ÙˆÙ‚Ø¹</label>
=======
						{{ form_row(form.reference, {'label': 'Ø§Ù„Ù…Ø±Ø¬Ø¹'}) }}
						<br>
						{{ form_row(form.nom, {'label': 'Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©'}) }}
						{# Label pour afficher la sÃ©lection #}
						<label id="nom-selection-label" class="form-label mt-2 text-muted">
							Aucune sÃ©lection
						</label>
						{{ form_row(form.emplacement, {'label': 'Ø§Ù„Ù…ÙˆÙ‚Ø¹'}) }}
                        <label id="emplacement-selection-label" class="form-label mt-2 text-muted">Aucune sÃ©lection</label>
>>>>>>> d6476d60ab6c137fd57e0e94d3b5e16948081daa
						{{ form_row(form.description, {'label': 'Ø§Ù„ÙˆØµÙ'}) }}
						{{ form_row(form.nbr, {'label': 'Ø§Ù„ÙƒÙ…ÙŠØ©', 'attr': {'class': 'form-control', 'type': 'number'}}) }}
						{{ form_row(form.dateAcquisition, {'label': 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù‚ØªÙ†Ø§Ø¡'}) }}
					</div>
					<div class="col-md-6">
						{{ form_row(form.etat, {'label': 'Ø§Ù„Ø­Ø§Ù„Ø©'}) }}
						{{ form_row(form.etablissement, {'label': 'Ø§Ù„Ù…Ø¤Ø³Ø³Ø©'}) }}

					</div>
				</div>
<<<<<<< HEAD
				<button class="btn btn-success mt-3" type="submit">
=======
				<button class="btn btn-success mt-3">
>>>>>>> d6476d60ab6c137fd57e0e94d3b5e16948081daa
					<i class="bi bi-save"></i>
					Ø­ÙØ¸ Ø§Ù„Ù…Ø§Ø¯Ø©
				</button>
				<a href="{{ path('materiel_index') }}" class="btn btn-secondary mt-3">
					<i class="bi bi-arrow-return-left"></i>
					Ø¹ÙˆØ¯Ø©
				</a>
				{{ form_end(form) }}
			</div>
		</div>
	</div>
<<<<<<< HEAD
	<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script> <!-- âœ… Avant Select2 -->
	 <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js  "></script>
	<script>
document.addEventListener("DOMContentLoaded", function() {
    //console.log("âœ… DOM chargÃ©");

    function initSelect2WithDisplay(selector, labelSelector, field) {
        //console.log("âœ… Initialisation de Select2 pour:", selector);

        $(selector).select2({
            placeholder: 'Ø¥Ø¨Ø­Ø«...',
            ajax: {
                url: '{{ path("materiel_search") }}',
                dataType: 'json',
                delay: 250,
                tags: true,
                data: function (params) {
                    //console.log("ğŸ” RequÃªte envoyÃ©e:", params.term);
                    //console.log("ğŸ” field envoyÃ©e:", field);
                    return {
                        q: params.term,
                        field: field
                    };
                },
                processResults: function (data) {
                    //console.log("ğŸ” RÃ©ponse reÃ§ue:", data);
                    return {
                        results: $.map(data, function (item) {
                            let text = item.text || item.text;
							let ids=item.id || item.id;
							let reference=item.reference || item.reference;
                            //console.log("Suggestion:", text);
                            return { id: ids, text: text};
                        })
                    };
                },
                error: function(xhr, status, error) {
                    //console.error("âŒ Erreur AJAX:", status, error);
                },
                cache: true
            },
            minimumInputLength: 2,
            theme: "bootstrap-5"
        }).on('select2:select', function (e) {
            // âœ… Mettre Ã  jour le label avec la valeur sÃ©lectionnÃ©e
            //console.log("Valeur sÃ©lectionnÃ©e:", e.params.data.text);
            $(labelSelector).text(e.params.data.text); // Mettre Ã  jour le label
            $(selector).val(e.params.data.id).trigger('change'); // Mettre Ã  jour le champ original (pour le formulaire)
        }).on('select2:clear', function () {
            // âœ… RÃ©initialiser le label si le champ est vidÃ©
            $(labelSelector).text('Ù„Ù… ØªØ­Ø¯Ø¯ ' + field);
        });
    }

    // âœ… Appliquer Ã  tous les champs
    initSelect2WithDisplay('#materiel_libelleMateriel', '#libelleMateriel-selection-label', 'nom'); // âœ… Nouveau champ
    initSelect2WithDisplay('#materiel_emplacement', '#emplacement-selection-label', 'emplacement');
});
</script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


{% endblock %}
=======
	 <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
	 <script>
		document.addEventListener("DOMContentLoaded", function() {
		    //console.log("âœ… DOM chargÃ©");

		    function initSelect2WithDisplay(selector, labelSelector, field) {
		        //console.log("âœ… Initialisation de Select2 pour:", selector);

		        $(selector).select2({
		            placeholder: 'Tapez pour rechercher...',
		            ajax: {
		                url: '{{ path("materiel_search") }}',
		                dataType: 'json',
		                delay: 250,
                        tags: true,
		                 data: function (params) {
		                    //console.log("ğŸ” RequÃªte envoyÃ©e:", params.term);
                            //console.log("ğŸ” field envoyÃ©e:", field);
		                    return {
		                        q: params.term,
		                        field: field
		                    };
		                },
		                processResults: function (data) {
		                    //console.log("ğŸ” RÃ©ponse reÃ§ue:", data);
		                    return {
		                       results: $.map(data, function (item) {
	                            let text = item.id || item.text;
	                           // console.log("Suggestion:", text);
	                            return { id: text, text: text };
	                        })
		                    };
		                },
		                error: function(xhr, status, error) {
		                    //console.error("âŒ Erreur AJAX:", status, error);
		                },
		                cache: true
		            },
		            minimumInputLength: 2,
		            theme: "bootstrap-5"
		        }).on('select2:select', function (e) {
	            // âœ… Mettre Ã  jour le label avec la valeur sÃ©lectionnÃ©e
	           // console.log("Valeur sÃ©lectionnÃ©e:", e.params.data.text);
	            $(labelSelector).text(e.params.data.text); // Mettre Ã  jour le label
	            $(selector).val(e.params.data.id).trigger('change'); // Mettre Ã  jour le champ original (pour le formulaire)
	        }).on('select2:clear', function () {
	            // âœ… RÃ©initialiser le label si le champ est vidÃ©
	            $(labelSelector).text('Aucune sÃ©lection');
	        });
		    }

		    // Appliquer Ã  chaque champ
	    initSelect2WithDisplay('#materiel_nom', '#nom-selection-label', 'nom');
	    initSelect2WithDisplay('#materiel_emplacement', '#emplacement-selection-label', 'emplacement');
		});
		</script>

{% endblock %}
>>>>>>> d6476d60ab6c137fd57e0e94d3b5e16948081daa
