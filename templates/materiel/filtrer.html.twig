{% extends 'base.html.twig' %}

{% block title %} ÙÙ„ØªØ±Ø© Ø§Ù„Ø¬Ø±Ø¯ {% endblock %}

{% block head %}
<link rel="stylesheet" href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.min.css">

{% endblock %} 

{% block body %}
<div class="container mt-4">
    <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
            <h2 class="mb-0"> ÙÙ„ØªØ±Ø© Ø§Ù„Ø¬Ø±Ø¯ </h2>
        </div>
        <div class="card-body">
            <!-- Formulaire de filtre -->
            <form method="GET" class="row g-3 mb-4">
                <div class="col-md-3">
                    <label for="date_debut" class="form-label"> ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù‚ØªÙ†Ø§Ø¡ (Ù…Ù†) </label>
                    <input type="date" class="form-control" id="date_debut" name="date_debut" value="{{ filters.date_debut }}">
                </div>
                <div class="col-md-3">
                    <label for="date_fin" class="form-label"> ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù‚ØªÙ†Ø§Ø¡ (Ø¥Ù„Ù‰) </label>
                    <input type="date" class="form-control" id="date_fin" name="date_fin" value="{{ filters.date_fin }}">
                </div>
                <div class="col-md-3">
                    <label for="etablissement" class="form-label"> Ø§Ù„Ù…Ø¤Ø³Ø³Ø© </label>
                    <select class="form-select" id="etablissement" name="etablissement">
                        <option value=""> Ø§Ù„ÙƒÙ„ </option>
                        
                        {% for etab in etablissements %}
                            <option value="{{ etab.id }}" {% if filters.etablissement == etab.id %}selected{% endif %}>
                                {{ etab.nom }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="emplacement" class="form-label"> Ø§Ù„Ù…ÙƒØ§Ù† </label>
                    <select class="form-select" id="emplacement" name="emplacement">
                        <option value=""> Ø§Ù„ÙƒÙ„ </option>
                        {% for emplacement in emplacements %}
                            <option value="{{ emplacement }}" {% if filters.emplacement == emplacement %}selected{% endif %}>
                                {{ emplacement }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="etat" class="form-label"> Ø§Ù„Ø­Ø§Ù„Ø© </label>
                    <select class="form-select" id="etat" name="etat">
                        <option value=""> Ø§Ù„ÙƒÙ„ </option>
                        {% for etat in etats %}
                            <option value="{{ etat }}" {% if filters.etat == etat %}selected{% endif %}>
                                {{ etat }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-12">
                    <button type="submit" class="btn btn-primary"> Ø¨Ø­Ø« </button>
                    <a href="{{ path('materiel_filtrer') }}" class="btn btn-secondary"> Ø¥Ù„ØºØ§Ø¡ </a>
                    <a href="{{ path('materiel_imprimer', app.request.query.all) }}" class="btn btn-success" target="_blank"> ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© </a>
                </div>
            </form>

            <!-- RÃ©sultats -->
            <div class="table-responsive">
                <table class="table table-striped table-hover" id="materielsTable">
                    <thead>
                        <tr>
                            <th> Ø§Ù„Ø§Ø³Ù… </th>
                            <th> Ø§Ù„Ù…Ø¤Ø³Ø³Ø© </th>
                            <th> Ø§Ù„Ù…ÙƒØ§Ù† </th>
                            <th> ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù‚ØªÙ†Ø§Ø¡ </th>
                            <th> Ø§Ù„Ø­Ø§Ù„Ø© </th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for materiel in materiels %}
                        <tr>
                            <td> {{ materiel.libelleMateriel.nom ?? 'N/A' }} </td>
                            <td> {{ materiel.etablissement.nom ?? 'N/A' }} </td>
                            <td> {{ materiel.emplacement ?? 'N/A' }} </td>
                            <td> {{ materiel.dateAcquisition ? materiel.dateAcquisition|date('d/m/Y') : 'N/A' }} </td>
                            <td> {{ materiel.etat ?? 'N/A' }} </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
<script>
$(document).ready(function() {
    $('#materielsTable').DataTable({
        "language": {
            "url": "https://cdn.datatables.net/plug-ins/2.0.8/i18n/ar.json"
        },
        "pageLength": 10,
        "responsive": true,
        "order": [[ 0, "asc" ]]
    });
});
</script>

{% endblock %}